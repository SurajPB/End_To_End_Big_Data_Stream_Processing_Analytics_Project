{"paragraphs":[{"text":"%md\n# Accident Prediction using Vehicle Black Box : Progress Report\n\n\nProgress Report for MidTerm Review : Accident Detection using Sample Dataset : Following Sequence of Operation is performed : Aquiring data, cleaning it, analyzing it for relationships, and then building a model","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Accident Prediction using Vehicle Black Box : Progress Report</h1>\n<p>Progress Report for MidTerm Review : Accident Detection using Sample Dataset : Following Sequence of Operation is performed : Aquiring data, cleaning it, analyzing it for relationships, and then building a model</p>\n"}]},"apps":[],"jobName":"paragraph_1605780829135_1430200698","id":"20150601-165313_1826054142","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:373"},{"text":"%md\n### Viewing pre-loaded data (sample dataset and Training Data) in HDFS","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Viewing pre-loaded data (sample dataset and Training Data) in HDFS</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829136_1440588919","id":"20150601-165442_638366896","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:374"},{"text":"%sh\nhadoop fs -ls /SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices","dateUpdated":"2020-11-19T14:41:43+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   1 root hdfs      38203 2020-11-19 08:50 /SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/enrcihedEvents\n-rw-r--r--   1 root hdfs      33084 2020-11-19 08:51 /SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/trainingData\n"}]},"apps":[],"jobName":"paragraph_1605780829136_1440588919","id":"20150812-230011_789008868","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:375","user":"anonymous","dateFinished":"2020-11-19T14:41:47+0000","dateStarted":"2020-11-19T14:41:43+0000"},{"text":"%sh\nhadoop fs -cat /SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/enrcihedEvents | tail -n 20","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605780829136_1440588919","id":"20150601-170021_1937004013","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:376"},{"text":"%md\n### Perform Exploratory Data Analysis (EDA) for understanding the data set.","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Perform Exploratory Data Analysis (EDA) for understanding the data set.</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829137_1440204170","id":"20150601-170447_179499526","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\nval eventsFile = sc.textFile(\"hdfs:///SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/enrcihedEvents\")\n\ncase class Event(eventType: String, \n                isCertified: String, \n                paymentScheme: String, \n                hoursDriven: Int, \n                milesDriven: Int, \n                lati: Float, \n                longi: Float, \n                isFoggy: Int, \n                isRainy: Int, \n                isWindy: Int)\n\nval eventsRDD = eventsFile.map(s => s.split(\",\")).map(\n    s => Event(s(0),        //eventType\n            s(1).replaceAll(\"\\\"\", \"\"),  //isCertified\n            s(2).replaceAll(\"\\\"\", \"\"),  //paymentScheme\n            s(3).toInt,     //hoursDriven\n            s(4).toInt,     //milesDriven\n            s(5).toFloat,   //latitude\n            s(6).toFloat,   //longitude\n            s(7).toInt,     //isFoggy\n            s(8).toInt,     //isRainy\n            s(9).toInt      //isWindy\n        )\n    )\n\n\neventsRDD.count\n\neventsRDD.toDF().registerTempTable(\"enrichedEvents\")\n","dateUpdated":"2020-11-19T13:00:44+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@6d0b82d3\neventsFile: org.apache.spark.rdd.RDD[String] = hdfs:///SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/enrcihedEvents MapPartitionsRDD[1948] at textFile at <console>:109\ndefined class Event\neventsRDD: org.apache.spark.rdd.RDD[Event] = MapPartitionsRDD[1950] at map at <console>:111\nres237: Long = 649\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1605780829137_1440204170","id":"20150601-171008_2061583323","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:378","user":"anonymous","dateFinished":"2020-11-19T13:00:47+0000","dateStarted":"2020-11-19T13:00:44+0000"},{"text":"%sql\n\nselect * from enrichedEvents order by hoursDriven desc limit 10","dateUpdated":"2020-11-19T13:02:18+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":true,"keys":[{"name":"eventType","index":0,"aggr":"sum"}],"values":[{"name":"isCertified","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"},"yAxis":{"name":"isCertified","index":1,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\tisCertified\tpaymentScheme\thoursDriven\tmilesDriven\tlati\tlongi\tisFoggy\tisRainy\tisWindy\nNormal\tN\tmiles\t90\t4300\t10.191698\t76.20155\t0\t0\t1\nLane Departure\tN\tmiles\t90\t4300\t10.202711\t76.20025\t1\t1\t1\nNormal\tN\tmiles\t90\t4300\t10.192757\t76.20156\t0\t0\t0\nOverspeed\tN\tmiles\t90\t4300\t10.192967\t76.20139\t1\t0\t0\nUnsafe tail distance\tN\tmiles\t90\t4300\t10.194767\t76.200935\t1\t1\t1\nNormal\tN\tmiles\t90\t4300\t10.197733\t76.200645\t0\t0\t0\nNormal\tN\tmiles\t90\t4300\t10.198903\t76.200455\t0\t0\t1\nNormal\tN\tmiles\t90\t4300\t10.199647\t76.200165\t0\t0\t0\nLane Departure\tN\tmiles\t90\t4300\t10.20092\t76.20019\t1\t0\t0\nUnsafe following distance\tN\tmiles\t90\t4300\t10.201659\t76.20021\t0\t1\t1\n"}]},"apps":[],"jobName":"paragraph_1605780829137_1440204170","id":"20150601-171149_802050103","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:379","user":"anonymous","dateFinished":"2020-11-19T13:02:18+0000","dateStarted":"2020-11-19T13:02:18+0000"},{"text":"%sql\n\nselect eventType, count(*) occurences from enrichedEvents group by eventType","dateUpdated":"2020-11-19T13:14:38+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"eventType","index":0,"aggr":"sum"}],"values":[{"name":"occurences","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\toccurences\nOverspeed\t28\nLane Departure\t27\nUnsafe tail distance\t23\nNormal\t551\nUnsafe following distance\t20\n"}]},"apps":[],"jobName":"paragraph_1605780829138_1441358416","id":"20150601-222257_227670657","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:381","focus":true},{"text":"%md\n### Whether certified drivers have less violations?","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Whether certified drivers have less violations?</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829137_1440204170","id":"20150601-171831_1908074493","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"%sql\n\nselect isCertified, count(*) numViolations from enrichedEvents where eventType in (\"Unsafe tail distance\", \"Overspeed\", \"Lane Departure\", \"Unsafe following distance\") group by isCertified","dateUpdated":"2020-11-19T13:32:34+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"isCertified","index":0,"aggr":"sum"}],"values":[{"name":"numViolations","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"isCertified","index":0,"aggr":"sum"}},"setting":{"multiBarChart":{}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"isCertified\tnumViolations\nY\t36\nN\t62\n"}]},"apps":[],"jobName":"paragraph_1605780829138_1441358416","id":"20150601-233700_861079238","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:382","focus":true},{"text":"%sql\nselect eventType, isCertified, hoursDriven from enrichedEvents group by isCertified, eventType, hoursDriven","dateUpdated":"2020-11-19T13:33:02+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"isCertified","index":1,"aggr":"sum"}],"values":[{"name":"eventType","index":0,"aggr":"sum"}],"groups":[{"name":"eventType","index":0,"aggr":"sum"}],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"},"yAxis":{"name":"hoursDriven","index":2,"aggr":"sum"},"group":{"name":"hoursDriven","index":2,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\tisCertified\thoursDriven\nNormal\tY\t54\nLane Departure\tY\t60\nNormal\tY\t56\nUnsafe tail distance\tY\t47\nNormal\tY\t50\nUnsafe following distance\tY\t57\nUnsafe tail distance\tY\t50\nUnsafe tail distance\tY\t52\nOverspeed\tN\t70\nUnsafe tail distance\tY\t60\nUnsafe tail distance\tN\t0\nLane Departure\tY\t51\nNormal\tY\t60\nNormal\tY\t49\nUnsafe following distance\tY\t49\nOverspeed\tY\t45\nOverspeed\tY\t60\nOverspeed\tN\t90\nNormal\tY\t51\nLane Departure\tY\t49\nUnsafe following distance\tN\t0\nOverspeed\tN\t0\nUnsafe tail distance\tY\t59\nLane Departure\tY\t56\nNormal\tY\t46\nNormal\tY\t59\nNormal\tY\t45\nUnsafe following distance\tN\t70\nUnsafe following distance\tY\t55\nOverspeed\tY\t52\nUnsafe following distance\tY\t45\nUnsafe following distance\tN\t90\nNormal\tN\t70\nNormal\tN\t0\nUnsafe tail distance\tN\t90\nLane Departure\tN\t90\nNormal\tY\t52\nLane Departure\tY\t45\nLane Departure\tY\t46\nOverspeed\tY\t56\nOverspeed\tY\t55\nNormal\tY\t55\nLane Departure\tN\t0\nUnsafe following distance\tY\t50\nNormal\tN\t90\nNormal\tY\t57\nUnsafe following distance\tY\t52\nOverspeed\tY\t59\nOverspeed\tY\t47\nLane Departure\tN\t70\nNormal\tY\t47\n"}]},"apps":[],"jobName":"paragraph_1605780829138_1441358416","id":"20150602-005637_838211375","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:383","user":"anonymous","dateFinished":"2020-11-19T13:20:46+0000","dateStarted":"2020-11-19T13:20:44+0000"},{"text":"%md \n### Do driver fatigue cause violations? - Pending to implement CNN based fatigue detection and feed into model in real time","dateUpdated":"2020-11-19T13:34:11+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Do driver fatigue cause violations? - Pending to implement CNN based fatigue detection and feed into model in real time</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829138_1441358416","id":"20150602-013120_170563003","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:384","user":"anonymous","dateFinished":"2020-11-19T13:34:11+0000","dateStarted":"2020-11-19T13:34:11+0000"},{"text":"%sql\n\nselect hoursDriven, eventType, count(*) numOccurences from enrichedEvents where eventType not in (\"Normal\") group by hoursDriven, eventType order by hoursDriven\n\n","dateUpdated":"2020-11-19T13:36:50+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"pieChart","height":232,"optionOpen":true,"keys":[{"name":"hoursDriven","index":0,"aggr":"sum"}],"values":[{"name":"numOccurences","index":2,"aggr":"count"}],"groups":[],"scatter":{"xAxis":{"name":"hoursDriven","index":0,"aggr":"sum"},"yAxis":{"name":"eventType","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":false},"lineChart":{"forceY":false}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{"eventType":"Normal"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hoursDriven\teventType\tnumOccurences\n0\tUnsafe following distance\t8\n0\tOverspeed\t11\n0\tLane Departure\t9\n0\tUnsafe tail distance\t12\n45\tLane Departure\t1\n45\tUnsafe following distance\t1\n45\tOverspeed\t3\n46\tLane Departure\t1\n47\tUnsafe tail distance\t2\n47\tOverspeed\t1\n49\tUnsafe following distance\t3\n49\tLane Departure\t2\n50\tUnsafe tail distance\t2\n50\tUnsafe following distance\t1\n51\tLane Departure\t1\n52\tUnsafe tail distance\t2\n52\tOverspeed\t2\n52\tUnsafe following distance\t1\n55\tUnsafe following distance\t1\n55\tOverspeed\t2\n56\tOverspeed\t1\n56\tLane Departure\t1\n57\tUnsafe following distance\t1\n59\tOverspeed\t1\n59\tUnsafe tail distance\t1\n60\tOverspeed\t2\n60\tLane Departure\t1\n60\tUnsafe tail distance\t2\n70\tOverspeed\t1\n70\tLane Departure\t7\n70\tUnsafe following distance\t2\n90\tUnsafe following distance\t2\n90\tLane Departure\t4\n90\tUnsafe tail distance\t2\n90\tOverspeed\t4\n"}]},"apps":[],"jobName":"paragraph_1605780829139_1440973667","id":"20150602-165735_472251841","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:385"},{"text":"%sql\n\nSELECT IF(((`enrichedEvents`.`eventType` = 'Lane Departure') OR (`enrichedEvents`.`eventType` = 'Overspeed') OR (`enrichedEvents`.`eventType` = 'Unsafe following distance') OR (`enrichedEvents`.`eventType` = 'Unsafe tail distance')),'Lane Departure',`enrichedEvents`.`eventType`) AS `grouped_events`, `enrichedEvents`.`hoursDriven` AS `none_hoursdriven_ok`, SUM(1) AS `sum_number_of_records_ok` FROM `enrichedEvents` `enrichedEvents` GROUP BY IF(((`enrichedEvents`.`eventType` = 'Lane Departure') OR (`enrichedEvents`.`eventType` = 'Overspeed') OR (`enrichedEvents`.`eventType` = 'Unsafe following distance') OR (`enrichedEvents`.`eventType` = 'Unsafe tail distance')),'Lane Departure',`enrichedEvents`.`eventType`), `enrichedEvents`.`hoursDriven`\n","dateUpdated":"2020-11-19T13:46:59+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"table","height":302,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}],"groups":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}},"setting":{"pieChart":{},"multiBarChart":{},"stackedAreaChart":{"style":"stack"}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_hoursdriven_ok\tsum_number_of_records_ok\nNormal\t57\t37\nNormal\t51\t19\nNormal\t45\t65\nNormal\t46\t13\nLane Departure\t57\t1\nLane Departure\t52\t5\nLane Departure\t90\t12\nLane Departure\t0\t40\nLane Departure\t49\t5\nLane Departure\t47\t3\nNormal\t90\t20\nLane Departure\t60\t5\nLane Departure\t51\t1\nNormal\t49\t47\nNormal\t60\t46\nNormal\t55\t23\nLane Departure\t55\t3\nNormal\t59\t38\nNormal\t0\t35\nNormal\t54\t38\nLane Departure\t56\t2\nNormal\t52\t48\nLane Departure\t50\t3\nNormal\t70\t57\nNormal\t50\t19\nNormal\t56\t34\nLane Departure\t70\t10\nLane Departure\t46\t1\nLane Departure\t59\t2\nNormal\t47\t12\nLane Departure\t45\t5\n"}]},"apps":[],"jobName":"paragraph_1605780829139_1440973667","id":"20150602-165744_1812152248","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isCertified AS num_certified, SUM(1) AS sum_number_of_records FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isCertified","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum","$$hashKey":"object:8685"}],"values":[{"name":"sum_number_of_records","index":2,"aggr":"sum","$$hashKey":"object:8689"}],"groups":[{"name":"num_certified","index":1,"aggr":"sum","$$hashKey":"object:8687"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"num_certified","index":1,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnum_certified\tsum_number_of_records\nNormal\tY\t439\nLane Departure\tN\t62\nLane Departure\tY\t36\nNormal\tN\t112\n"}]},"apps":[],"jobName":"paragraph_1605780829139_1440973667","id":"20150602-183904_189812181","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"text":"%md\n### What's the impact of fog on driving?","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>What's the impact of fog on driving?</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829139_1440973667","id":"20150602-185736_1176020804","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"text":"%sql\n\n\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isFoggy AS `num_foggy`, SUM(1) AS sum_number_of_records FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isFoggy","dateUpdated":"2020-11-19T13:48:53+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records","index":2,"aggr":"sum"}],"groups":[{"name":"num_foggy","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"num_foggy","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnum_foggy\tsum_number_of_records\nLane Departure\t1\t69\nLane Departure\t0\t29\nNormal\t0\t477\nNormal\t1\t74\n"}]},"apps":[],"jobName":"paragraph_1605780829139_1440973667","id":"20150603-005352_2051370027","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"text":"%md \n##What's the impact of rain on driving?","dateUpdated":"2020-11-19T11:25:01+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605780829140_1439049923","id":"20150603-082821_53714184","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:390","user":"anonymous","dateFinished":"2020-11-19T11:25:01+0000","dateStarted":"2020-11-19T11:25:01+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>What's the impact of rain on driving?</h2>\n"}]}},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isRainy AS `none_rainy_ok`, SUM(1) AS `sum_number_of_records_ok` FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isRainy","dateUpdated":"2020-11-19T13:50:15+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"groups":[{"name":"none_rainy_ok","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_rainy_ok","index":1,"aggr":"sum"}}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_rainy_ok\tsum_number_of_records_ok\nLane Departure\t1\t57\nLane Departure\t0\t41\nNormal\t0\t475\nNormal\t1\t76\n"}]},"apps":[],"jobName":"paragraph_1605780829140_1439049923","id":"20150603-161651_886203277","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:391"},{"text":"%md\n\n## What's the impact of wind on driving?","dateUpdated":"2020-11-19T11:25:41+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605780829140_1439049923","id":"20150603-085134_652083579","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:392","user":"anonymous","dateFinished":"2020-11-19T11:25:41+0000","dateStarted":"2020-11-19T11:25:41+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>What's the impact of wind on driving?</h2>\n"}]}},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isWindy AS `none_windy_ok`, SUM(1) AS `sum_number_of_records_ok` FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isWindy","dateUpdated":"2020-11-19T14:00:30+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"groups":[{"name":"none_windy_ok","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_windy_ok","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_windy_ok\tsum_number_of_records_ok\nLane Departure\t1\t33\nLane Departure\t0\t65\nNormal\t0\t415\nNormal\t1\t136\n"}]},"apps":[],"jobName":"paragraph_1605780829141_1438665174","id":"20150603-085501_2095284086","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:393","user":"anonymous","dateFinished":"2020-11-19T13:53:53+0000","dateStarted":"2020-11-19T13:53:50+0000"},{"text":"%md\n\n### Does location have any impact on incidents?","dateUpdated":"2020-11-19T10:13:49+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Does location have any impact on incidents?</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829141_1438665174","id":"20150612-103100_302525333","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:394"},{"text":"%sql\n\nselect lati, longi, eventType, isFoggy from enrichedEvents where eventType not in ('Normal') and isFoggy = 1 group by lati, longi, eventType, isFoggy ","dateUpdated":"2020-11-19T13:51:23+0000","config":{"tableHide":false,"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"scatterChart","height":288,"optionOpen":true,"keys":[{"name":"eventType","index":2,"aggr":"sum"}],"values":[{"name":"long","index":1,"aggr":"sum"}],"groups":[{"name":"eventType","index":2,"aggr":"sum"}],"scatter":{"xAxis":{"name":"long","index":1,"aggr":"sum"},"yAxis":{"name":"lat","index":0,"aggr":"sum"},"group":{"name":"isFoggy","index":3,"aggr":"sum"}},"setting":{"scatterChart":{"xAxis":{"name":"lati","index":0,"aggr":"sum"},"yAxis":{"name":"longi","index":1,"aggr":"sum"},"group":{"name":"eventType","index":2,"aggr":"sum"}}}}}],"enabled":true},"settings":{"params":{"eventType":"Unsafe tail distance"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"lati\tlongi\teventType\tisFoggy\n10.178325\t76.18005\tOverspeed\t1\n10.260941\t76.204124\tLane Departure\t1\n10.247803\t76.18842\tOverspeed\t1\n10.179063\t76.1804\tLane Departure\t1\n10.181958\t76.18711\tOverspeed\t1\n10.209749\t76.16357\tLane Departure\t1\n10.289926\t76.15651\tOverspeed\t1\n10.239071\t76.1911\tLane Departure\t1\n10.215498\t76.20255\tLane Departure\t1\n10.185086\t76.17397\tUnsafe following distance\t1\n10.179993\t76.1817\tUnsafe tail distance\t1\n10.1812\t76.184296\tUnsafe tail distance\t1\n10.205557\t76.20143\tOverspeed\t1\n10.182612\t76.19066\tUnsafe tail distance\t1\n10.21752\t76.20209\tOverspeed\t1\n10.202711\t76.20025\tLane Departure\t1\n10.27333\t76.17409\tOverspeed\t1\n10.20869\t76.16388\tLane Departure\t1\n10.248023\t76.18779\tLane Departure\t1\n10.1840315\t76.17384\tUnsafe following distance\t1\n10.182346\t76.18873\tUnsafe tail distance\t1\n10.289191\t76.18302\tLane Departure\t1\n10.180498\t76.182465\tOverspeed\t1\n10.189464\t76.20234\tUnsafe tail distance\t1\n10.182152\t76.18776\tUnsafe tail distance\t1\n10.280353\t76.197845\tUnsafe following distance\t1\n10.280102\t76.18559\tUnsafe tail distance\t1\n10.278164\t76.173294\tOverspeed\t1\n10.175675\t76.180016\tLane Departure\t1\n10.204397\t76.20029\tUnsafe tail distance\t1\n10.265551\t76.1415\tLane Departure\t1\n10.192967\t76.20139\tOverspeed\t1\n10.195833\t76.17125\tOverspeed\t1\n10.177587\t76.180016\tUnsafe following distance\t1\n10.189991\t76.20204\tLane Departure\t1\n10.280267\t76.18506\tUnsafe following distance\t1\n10.269462\t76.16477\tUnsafe tail distance\t1\n10.181167\t76.185486\tOverspeed\t1\n10.218936\t76.159424\tLane Departure\t1\n10.301052\t76.153\tUnsafe following distance\t1\n10.207575\t76.20341\tOverspeed\t1\n10.174088\t76.18121\tOverspeed\t1\n10.280433\t76.18451\tUnsafe tail distance\t1\n10.272099\t76.17187\tUnsafe tail distance\t1\n10.194767\t76.200935\tUnsafe tail distance\t1\n10.288506\t76.15713\tUnsafe tail distance\t1\n10.174801\t76.18124\tUnsafe following distance\t1\n10.301671\t76.152794\tOverspeed\t1\n10.285426\t76.1851\tUnsafe following distance\t1\n10.185943\t76.19601\tOverspeed\t1\n10.279878\t76.19376\tUnsafe following distance\t1\n10.1811695\t76.1844\tOverspeed\t1\n10.184348\t76.173965\tUnsafe following distance\t1\n10.1815605\t76.18646\tLane Departure\t1\n10.288975\t76.15682\tOverspeed\t1\n10.286746\t76.1691\tUnsafe tail distance\t1\n10.286538\t76.18501\tLane Departure\t1\n10.287752\t76.184204\tUnsafe following distance\t1\n10.179793\t76.18083\tLane Departure\t1\n10.190844\t76.20164\tUnsafe following distance\t1\n10.207158\t76.20308\tLane Departure\t1\n10.180901\t76.18311\tUnsafe tail distance\t1\n10.183173\t76.19273\tUnsafe following distance\t1\n10.1882\t76.2023\tUnsafe tail distance\t1\n10.182621\t76.1897\tUnsafe tail distance\t1\n10.20092\t76.20019\tLane Departure\t1\n10.218193\t76.15982\tLane Departure\t1\n10.269237\t76.16488\tUnsafe tail distance\t1\n10.293049\t76.155396\tOverspeed\t1\n"}]},"apps":[],"jobName":"paragraph_1605780829141_1438665174","id":"20150603-182617_1986095422","dateCreated":"2020-11-19T10:13:49+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:395"},{"text":"%md\n\n### Build a regression model to predict violations","dateUpdated":"2020-11-19T16:30:26+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Build a regression model to predict violations</h3>\n"}]},"apps":[],"jobName":"paragraph_1605780829141_1438665174","id":"20150612-103159_813648130","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:396","user":"anonymous","dateFinished":"2020-11-19T16:30:26+0000","dateStarted":"2020-11-19T16:30:26+0000"},{"text":"import org.apache.spark.mllib.util.MLUtils;\nimport org.apache.spark.mllib.optimization;\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD;\nimport org.apache.spark.mllib.optimization.SquaredL2Updater;\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics;\n\n    val examples = MLUtils.loadLabeledPoints(sc,\"hdfs:///SurajPB/MidTermReview/SampleSensorDataFromEdgeDevices/trainingData\").cache()\n\n    val splits = examples.randomSplit(Array(0.8, 0.2))\n    val training = splits(0).cache()\n    val test = splits(1).cache()\n\n    val numTraining = training.count()\n    val numTest = test.count()\n    println(s\"Training: $numTraining, test: $numTest.\")\n    \n    val updater = new SquaredL2Updater()\n    \n     val model = {\n        val algorithm = new LogisticRegressionWithSGD()\n        algorithm.optimizer.setNumIterations(200).setStepSize(1.0).setUpdater(updater).setRegParam(0.1)\n        algorithm.run(training).clearThreshold()\n     }   \n        \n    val rprediction = model.predict(test.map(_.features))\n    val rpredictionAndLabel = rprediction.zip(test.map(_.label))\n    val rmetrics = new BinaryClassificationMetrics(rpredictionAndLabel)\n\n    println(\"\\n\");\n    println(\"Certification Weight \" + model.weights(0))\n    println(\"Wage Plan Weight \" + model.weights(1))\n    println(\"Fatigue by Hours Weight \" + model.weights(2))\n    println(\"Fatigue by Miles Weight \" + model.weights(3))\n    println(\"Foggy weather Weight \" + model.weights(4))\n    println(\"Rainy weather Weight \" + model.weights(5))\n    println(\"Windy weather Weight \" + model.weights(6))\n    println(\"\\n\")\n    println(\"Intercept \" + model.intercept)\n    println(s\"Test areaUnderPR = ${rmetrics.areaUnderPR()}.\")\n    println(s\"Test areaUnderROC = ${rmetrics.areaUnderROC()}.\")","dateUpdated":"2020-11-19T14:18:12+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.util.MLUtils\nimport org.apache.spark.mllib.optimization\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD\nimport org.apache.spark.mllib.optimization.SquaredL2Updater\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nexamples: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[1979] at map at MLUtils.scala:216\nsplits: Array[org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint]] = Array(MapPartitionsRDD[1980] at randomSplit at <console>:115, MapPartitionsRDD[1981] at randomSplit at <console>:115)\ntraining: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[1980] at randomSplit at <console>:115\ntest: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[1981] at randomSplit at <console>:115\nnumTraining: Long = 1101\nnumTest: Long = 258\nTraining: 1101, test: 258.\nupdater: org.apache.spark.mllib.optimization.SquaredL2Updater = org.apache.spark.mllib.optimization.SquaredL2Updater@63e7eea6\nwarning: there was one deprecation warning; re-run with -deprecation for details\nmodel: org.apache.spark.mllib.classification.LogisticRegressionModel = org.apache.spark.mllib.classification.LogisticRegressionModel: intercept = 0.0, numFeatures = 7, numClasses = 2, threshold = None\nrprediction: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[2162] at mapPartitions at GeneralizedLinearAlgorithm.scala:70\nrpredictionAndLabel: org.apache.spark.rdd.RDD[(Double, Double)] = ZippedPartitionsRDD2[2164] at zip at <console>:116\nrmetrics: org.apache.spark.mllib.evaluation.BinaryClassificationMetrics = org.apache.spark.mllib.evaluation.BinaryClassificationMetrics@71e13e32\n\n\nCertification Weight 0.0\nWage Plan Weight 0.0\nFatigue by Hours Weight -1.0241937808977322\nFatigue by Miles Weight -0.5084820183160745\nFoggy weather Weight 0.10450456024903886\nRainy weather Weight 0.01075555713264873\nWindy weather Weight -0.3839579715309708\n\n\nIntercept 0.0\nTest areaUnderPR = 0.2984183381456842.\nTest areaUnderROC = 0.5392075596816975.\n"}]},"apps":[],"jobName":"paragraph_1605780829142_1439819421","id":"20150603-085258_1341928479","dateCreated":"2020-11-19T10:13:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:397","user":"anonymous","dateFinished":"2020-11-19T14:18:31+0000","dateStarted":"2020-11-19T14:18:12+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605795492459_336354419","id":"20201119-141812_1259481313","dateCreated":"2020-11-19T14:18:12+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5868"}],"name":"Vehicle Black Box - Accident Prediction","id":"2FQ3ETE71","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}